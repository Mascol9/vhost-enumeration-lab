# Default vhost - catches all requests that don't match other vhosts
<VirtualHost *:80>
    ServerName default.test.local
    DocumentRoot "/usr/local/apache2/htdocs/default"
    
    <Directory "/usr/local/apache2/htdocs/default">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

# Public vhost A
<VirtualHost *:80>
    ServerName a.test.local
    DocumentRoot "/usr/local/apache2/htdocs/a"

    <Directory "/usr/local/apache2/htdocs/a">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

# Public vhost B
<VirtualHost *:80>
    ServerName b.test.local
    DocumentRoot "/usr/local/apache2/htdocs/b"

    <Directory "/usr/local/apache2/htdocs/b">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

# Hidden vhost for enumeration testing
<VirtualHost *:80>
    ServerName admin.test.local
    DocumentRoot "/usr/local/apache2/htdocs/admin"

    <Directory "/usr/local/apache2/htdocs/admin">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

# Another hidden vhost
<VirtualHost *:80>
    ServerName internal.test.local
    DocumentRoot "/usr/local/apache2/htdocs/internal"

    <Directory "/usr/local/apache2/htdocs/internal">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

# VHost that returns 403 Forbidden
<VirtualHost *:80>
    ServerName forbidden.test.local
    DocumentRoot "/usr/local/apache2/htdocs/forbidden"

    <Directory "/usr/local/apache2/htdocs/forbidden">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all denied
    </Directory>
</VirtualHost>

# VHost that returns 404 Not Found
<VirtualHost *:80>
    ServerName notfound.test.local
    DocumentRoot "/usr/local/apache2/htdocs/notfound"

    <Directory "/usr/local/apache2/htdocs/notfound">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>

# VHost that redirects to another site
<VirtualHost *:80>
    ServerName redirect.test.local
    DocumentRoot "/usr/local/apache2/htdocs/redirect"

    <Directory "/usr/local/apache2/htdocs/redirect">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    Redirect permanent / https://google.com
</VirtualHost>

# VHost that returns 500 Internal Server Error
<VirtualHost *:80>
    ServerName error.test.local
    DocumentRoot "/usr/local/apache2/htdocs/error"

    <Directory "/usr/local/apache2/htdocs/error">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # Force 500 error
    ErrorDocument 500 /500.html
</VirtualHost>

# VHost that returns 200 but with custom content
<VirtualHost *:80>
    ServerName api.test.local
    DocumentRoot "/usr/local/apache2/htdocs/api"

    <Directory "/usr/local/apache2/htdocs/api">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>
</VirtualHost>

# VHost that requires authentication
<VirtualHost *:80>
    ServerName secure.test.local
    DocumentRoot "/usr/local/apache2/htdocs/secure"

    <Directory "/usr/local/apache2/htdocs/secure">
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
        AuthType Basic
        AuthName "Secure Area"
        AuthUserFile /usr/local/apache2/htdocs/secure/.htpasswd
        Require valid-user
    </Directory>
</VirtualHost>

